!function(e,t){var n="0.1.0",r=function(){function n(){return null}function r(){}function o(e){var t=/^\s*<!\[CDATA\[([\s\S]*)\]\]>\s*$/,n=e.match(t);return n&&n[1]?n[1]:e}function u(t){t&&(e.execScript||function(t){e.eval.call(e,t)})(t)}function a(t){var n=e.location,r=document.createElement("a");return r.href=t,r.hostname==n.hostname&&r.port==n.port&&r.protocol==n.protocol}function c(e){var t=e.getAttribute("href");if(!t)return!1;var n,r=document.styleSheets,o=r.length;for(n=0;o>n;n++)if(r[n].href==t)return!0;return!1}function i(e){var t=e.getAttribute("src");if(!t)return!1;var n,r=document.getElementsByTagName("script"),o=r.length;for(n=0;o>n;n++)if(r[n].getAttribute("src")==t)return!0;return!1}function l(e){var t=e.getAttribute("data-wi-loadchk");if(!t)return!1;try{return u("!!("+t+")")}catch(n){return!1}}function s(e){if(e){var t=o(e),n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,u=document.createElement("style");u.setAttribute("type","text/css"),u.styleSheet?u.styleSheet.cssText=t:u.appendChild(document.createTextNode(t)),n.appendChild(u),r("Style: "+t.substring(0,100))}}function d(e){var t=document.head||document.getElementsByTagName("head")[0]||document.documentElement,n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",e),t.appendChild(n),r("Link: "+e)}function m(e){var t=e.querySelectorAll('style, link[rel="stylesheet"], script');v=[];var n,r=t.length;for(n=0;r>n;n++){var o=t[n];switch(o.tagName.toLowerCase()){case"style":if(!l(o)){var u=o.firstChild;u&&s(u.textContent||u.nodeValue||"")}break;case"link":l(o)||c(o)||d(o.getAttribute("href"));break;case"script":l(o)||i(o)||v.push(o)}o.parentNode.removeChild(o)}}function f(){setTimeout(function(){var e=v[b];if(!e)return w();b++;var t=e.getAttribute("src");t?p(t):h(e.innerHTML)},0)}function p(e,t){var n=t||1e4,o=document.createElement("script"),u=!1,a=document.body||document.getElementsByTagName("body")[0]||document.documentElement;o.onreadystatechange=o.onload=function(t,n){u||!n&&o.readyState&&!/loaded|complete/.test(o.readyState)||(u=!0,n||r("Script: "+e),f()),o.onload=o.onreadystatechange=null},o.src=e,a.appendChild(o),setTimeout(function(){u||(y("Timeout: "+e),o.parentNode&&o.parentNode.removeChild(o),o.onload(null,!0))},n)}function h(e){if(e){var t=o(e);try{u(t),r("Eval: "+t.substring(0,100))}catch(n){y("Eval error: "+n.message+" ~~~ "+t.substring(0,100))}}f()}var g=function(){return e.console&&"function"==typeof e.console.log?function(){e.console.log.apply(e.console,arguments)}:e.opera&&"function"==typeof e.opera.postError?function(){e.opera.postError.apply(e.opera,arguments)}:(e.wamer.include.log||(e.wamer.include.log=[]),function(){e.wamer.include.log.push(Array.prototype.join.call(arguments," "))})}(),y=g,v=[],b=0,w=n;!function(){function o(n){var r,o;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(o=new DOMParser,r=o.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(u){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||y("XML parse error: "+n.substring(0,100)),r}function u(){var e=new XMLHttpRequest;return"withCredentials"in e}function c(e,t){var n=d();null!==n&&(n.open("GET",e,!0),n.onerror=function(){y("HTML request error")},n.onload=function(){t(n.responseText)},n.send(null))}function i(e){return'<?xml version="1.0" encoding="UTF-8" ?><wm-xml xmlns:ws="http://wamer.net/stencils">\n'+(e&&"string"==typeof e?e.replace(/<!DOCTYPE[^>]*>/,""):"")+"\n</wm-xml>"}function l(){T>v&&(g(C[v]),v++)}var s=function(){var t="https:"===e.location.protocol?"https:":"http:",n="//query.yahooapis.com/v1/public/yql?q=",r=encodeURIComponent("select * from html where url = ")+"%27",o="%27"+encodeURIComponent(" and xpath=")+"%27/html%27";return function(e){return t+n+r+encodeURIComponent(e)+o}}(),d=n;e.XMLHttpRequest&&u()?d=function(){return new XMLHttpRequest}:e.XDomainRequest?d=function(){return new XDomainRequest}:y("CORS not supported");var p=function(e,t){var n=o(e);if(null!==n){m(n);var u=n.getElementsByTagName("body");if(1===u.length){var a=u[0];t.innerHTML=a.innerHTML||a.xml;for(var c=t.parentNode;t.hasChildNodes();)c.insertBefore(t.removeChild(t.firstChild),t);c.removeChild(t),r("Body injected OK")}else y("No body tag found");b=0,f()}},h="data-wi-src",g=function(e){var t=e.getAttribute(h),n=a(t),r=n?t:s(t);c(r,function(t){var r=n?i(t):t;p(r,e)})},v=0,T=0,C=[];w=l,setTimeout(function(){C=document.querySelectorAll("["+h+"]"),T=C.length,T&&l()},0)}()};r.version=n,r(),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=r:(e.wmHtmlInclude=r,"function"==typeof define&&define.amd&&define("wm-html-include",[],function(){return r}))}(window);
